(function(g,m,r,e){function k(a,b){try{return m.hasOwnProperty?a.hasOwnProperty(b.toString()):Object.prototype.hasOwnProperty.call(a,b.toString())}catch(c){}}function l(a){var b=a.css||"";this.setValues(a);this.span=g("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(b);this.div=g("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function n(a,b){k(m,"google")&&(this.map=null,this.container=a,this.options=g.extend({},q,b),this.interval=
parseInt(this.options.interval,10),this.interval=isNaN(this.interval)?200:this.interval,this.GoogleMapOptions={center:new google.maps.LatLng(this.options.center.x,this.options.center.y),control:this.options.control,disableDefaultUI:this.options.disableDefaultUI,draggable:this.options.draggable,keyboardShortcuts:this.options.keyboardShortcuts,mapTypeId:google.maps.MapTypeId[this.options.mapTypeId.toUpperCase()],mapTypeControl:this.options.mapTypeControl,mapTypeControlOptions:{position:google.maps.ControlPosition[this.options.mapTypeControlOptions.position],
style:google.maps.MapTypeControlStyle[this.options.mapTypeControlOptions.style.toUpperCase()]},maxZoom:this.options.maxZoom,minZoom:this.options.minZoom,navigationControl:this.options.navigationControl,navigationControlOptions:{position:google.maps.ControlPosition[this.options.navigationControlOptions.position],style:google.maps.NavigationControlStyle[this.options.navigationControlOptions.style.toUpperCase()]},panControl:this.options.panControl,panControlOptions:{position:google.maps.ControlPosition[this.options.panControlOptions.position]},
rotateControl:this.options.rotateControl,scaleControl:this.options.scaleControl,scaleControlOptions:{position:google.maps.ControlPosition[this.options.scaleControlOptions.position],style:google.maps.ScaleControlStyle[this.options.scaleControlOptions.style.toUpperCase()]},scrollwheel:this.options.scrollwheel,streetViewControl:this.options.streetViewControl,streetViewControlOptions:{position:google.maps.ControlPosition[this.options.streetViewControlOptions.position]},zoom:this.options.zoom,zoomControl:this.options.zoomControl,
zoomControlOptions:{position:google.maps.ControlPosition[this.options.zoomControlOptions.position],style:google.maps.ZoomControlStyle[this.options.zoomControlOptions.style.toUpperCase()]}},g(this.container).html(this.options.loading),this.init())}var p=0,q={center:{x:"24",y:"121"},control:!0,disableDefaultUI:!1,draggable:!0,keyboardShortcuts:!0,mapTypeControl:!0,mapTypeControlOptions:{position:"TOP_RIGHT",style:"DEFAULT"},mapTypeId:"ROADMAP",marker:[],markerFitBounds:!1,maxZoom:null,minZoom:null,
panControl:!0,panControlOptions:{position:"LEFT_TOP"},polyline:[],navigationControl:!0,navigationControlOptions:{position:"TOP_LEFT",style:"DEFAULT"},scaleControl:!0,scaleControlOptions:{position:"BOTTOM_LEFT",style:"DEFAULT"},scrollwheel:!0,streetViewControl:!0,streetViewControlOptions:{position:"LEFT_TOP"},zoom:4,zoomControl:!0,zoomControlOptions:{style:"LARGE",position:"LEFT_TOP"},notfound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",loading:"\u8b80\u53d6\u4e2d\u2026",kml:{url:"",viewport:!0,
infowindow:!1},interval:200};l.prototype=new google.maps.OverlayView;l.prototype.onAdd=function(){var a=this.getPanes().overlayLayer;this.div.appendTo(g(a));this.listeners=[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};l.prototype.draw=function(){var a=this.getProjection().fromLatLngToDivPixel(this.get("position"));this.div.css({left:a.x+"px",top:a.y+"px",display:"block"});this.text&&this.span.html(this.text.toString())};l.prototype.onRemove=function(){g(this.div).remove()};
n.prototype={VERSION:"2.5.5",_markers:[],_labels:[],_polylines:[],_polygons:[],_circles:[],_kmls:[],_directions:[],bounds:new google.maps.LatLngBounds,setZoom:function(a,b){k(b,"zoom")&&a&&a.setZoom(b.zoom)},kml:function(a,b){b=b?b:this.options;var c={},d="",c={};e!==b.kml&&(c={preserveViewport:!0,suppressInfoWindows:!1},d="string"===typeof b.kml&&0!==b.kml.length?b.kml:e!==b.kml.url?b.kml.url:"",c=new google.maps.KmlLayer(d,g.extend(c,b.kml)),this._kmls.push(c),c.setMap(a))},direction:function(a,
b){var c="";b=b?b:this.options;if(e!==b.direction&&0<b.direction.length)for(c in b.direction)k(b.direction,c)&&e!==b.direction[c]&&this.DirectionService(b.direction[c])},markers:function(a,b){var c="";b=b?b:this.options;if(e!==b.marker&&0<b.marker.length)for(c in b.marker)k(b.marker,c)&&k(b.marker[c],"addr")&&("object"===typeof b.marker[c].addr?2===b.marker[c].addr.length&&this.MarkerDirect(b.marker[c]):this.MarkerByGeocoder(b.marker[c]))},DrawPolyline:function(a,b){var c={},c="",d={},f=[];b=b?b:
this.options;if(e!==b.polyline&&e!==b.polyline.coords){for(c in b.polyline.coords)k(b.polyline.coords,c)&&(d=b.polyline.coords,e!==d[c]&&f.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polyline({path:f,strokeColor:b.polyline.color||"#FF0000",strokeOpacity:1,strokeWeight:b.polyline.width||2});this._polylines.push(c);c.setMap(a)}},DrawPolygon:function(a,b){var c={},c="",d={},f=[];b=b?b:this.options;if(e!==b.polygon&&e!==b.polygon.coords){for(c in b.polygon.coords)k(b.polygon.coords,
c)&&(d=b.polygon.coords,e!==d[c]&&f.push(new google.maps.LatLng(d[c][0],d[c][1])));c=new google.maps.Polygon({path:f,strokeColor:b.polygon.color||"#FF0000",strokeOpacity:1,strokeWeight:b.polygon.width||2,fillColor:b.polygon.fillcolor||"#CC0000",fillOpacity:0.35});this._polygons.push(c);c.setMap(this.map);g.isFunction(b.polygon.click)&&google.maps.event.addListener(c,"click",b.polygon.click)}},DrawCircle:function(a,b){var c=0,d={},d={};b=b?b:this.options;if(e!==b.circle&&0<b.circle.length)for(c=b.circle.length-
1;0<=c;c-=1)d=b.circle[c],e!==d.center.x&&e!==d.center.y&&(d=new google.maps.Circle({strokeColor:d.color||"#FF0000",strokeOpacity:d.opacity||0.8,strokeWeight:d.width||2,fillColor:d.fillcolor||"#FF0000",fillOpacity:d.fillopacity||0.35,map:this.map,center:new google.maps.LatLng(d.center.x,d.center.y),radius:d.radius||10,zIndex:100}),this._circles.push(d),g.isFunction(b.circle[c].click)&&google.maps.event.addListener(d,"click",b.circle[c].click))},overlay:function(){this.kml(this.map);this.direction(this.map);
this.markers(this.map);this.DrawPolyline(this.map);this.DrawPolygon(this.map);this.DrawCircle(this.map)},MarkerDirect:function(a){var b=this,c,d;d={map:this.map,position:new google.maps.LatLng(a.addr[0],a.addr[1]),title:a.text.replace(/<([^>]+)>/g,""),infoWindow:new google.maps.InfoWindow({content:a.text})};var f={},f={};"string"===typeof a.icon?d.icon=a.icon:k(a.icon,"url")&&(f=k(a.icon,"anchor")&&e!==a.icon.anchor[1]?new google.maps.Point(a.icon.anchor[0],a.icon.anchor[1]):new google.maps.Point(0,
0),f=new google.maps.MarkerImage(a.icon.url,null,new google.maps.Point(0,0),f),d.icon=f);c=new google.maps.Marker(d);this._markers.push(c);k(c,"position")&&c.getPosition().lat()&&c.getPosition().lng()&&b.bounds.extend(d.position);d={map:this.map,css:e!==a.css?a.css:""};"string"===typeof a.label&&0!==a.label.length&&(d.text=a.label);a=new l(d);a.bindTo("position",c,"position");a.bindTo("text",c,"position");a.bindTo("visible",c);google.maps.event.addListener(c,"click",function(){c.infoWindow.open(b.map,
c)})},MarkerByGeocoder:function(a){var b=new google.maps.Geocoder,c=this;-1!==a.addr.indexOf(",")&&(a.addr="loc: "+a.addr);b.geocode({address:a.addr},function(b,f){if(f===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)m.setTimeout(function(){c.MarkerByGeocoder(a)},this.interval);else if(f===google.maps.GeocoderStatus.OK){var e,h;h={map:c.map,position:b[0].geometry.location,title:a.text.replace(/<([^>]+)>/g,""),infoWindow:new google.maps.InfoWindow({content:a.text})};"string"===typeof a.icon&&(h.icon=
a.icon);e=new google.maps.Marker(h);c._markers.push(e);k(e,"position")&&e.getPosition().lat()&&e.getPosition().lng()&&c.bounds.extend(h.position);h={map:c.map,css:a.css||""};"string"===typeof a.label&&0!==a.label.length&&(h.text=a.label);h=new l(h);h.bindTo("position",e,"position");h.bindTo("text",e,"position");h.bindTo("visible",e);google.maps.event.addListener(e,"click",function(){e.infoWindow.open(c.map,e)})}})},DirectionService:function(a){var b=[],c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,
f={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:a.optimize||!1},g=0,h=0;"string"===typeof a.from&&(f.origin=a.from);"string"===typeof a.to&&(f.destination=a.to);"string"===typeof a.travel&&0<a.travel.length&&(f.travelMode=google.maps.DirectionsTravelMode[a.travel.toUpperCase()]);if(e!==a.waypoint&&0!==a.waypoint){g=0;for(h=a.waypoint.length;g<h;g+=1)b.push({location:a.waypoint[g].toString(),stopover:!0});f.waypoints=b}e!==f.origin&&e!==f.destination&&(c.route(f,function(a,
b){b===google.maps.DirectionsStatus.OK&&d.setDirections(a)}),d.setMap(this.map),this._directions.push(d))},init:function(){var a=this,b={};p+=1;"string"===typeof this.options.center?m.setTimeout(function(){var c=g(a.container),d="";-1!==a.options.center.indexOf(",")&&(a.options.center="loc: "+a.options.center);b=new google.maps.Geocoder;b.geocode({address:a.options.center},function(b,g){try{g===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?a.init():g===google.maps.GeocoderStatus.OK&&0!==b.length?(a.GoogleMapOptions.center=
g===google.maps.GeocoderStatus.OK&&0!==b.length?b[0].geometry.location:"",a.map=new google.maps.Map(a.container,a.GoogleMapOptions),google.maps.event.addListenerOnce(a.map,"idle",function(){a.overlay();a.options.marker.length&&!0===a.options.markerFitBounds&&setTimeout(function(){a.map.fitBounds(a.bounds)},this.interval)})):(d=a.options.notfound.text||g,c.html(d.replace(/</g,"&lt;").replace(/>/g,"&gt;")))}catch(h){c.html((e!==h.message?h.message:h.description).toString())}})},this.interval*p):(a.map=
new google.maps.Map(a.container,a.GoogleMapOptions),google.maps.event.addListenerOnce(a.map,"idle",function(){a.overlay();a.options.marker.length&&!0===a.options.markerFitBounds&&a.map.fitBounds(a.bounds)}))},panto:function(a){var b=this,c="",d={};k(b,"map")&&null!==b.map&&e!==b.map&&("string"===typeof a?(-1!==a.indexOf(",")&&(c="loc: "+a),d=new google.maps.Geocoder,d.geocode({address:a},function(a,c){c===google.maps.GeocoderStatus.OK&&g.isFunction(b.map.panTo)&&e!==a[0]&&b.map.panTo(a[0].geometry.location)})):
("[object Array]"===Object.prototype.toString.call(a)?2===a.length&&(c=new google.maps.LatLng(a[0],a[1])):k(a,"lat")&&k(a,"lng")?c=new google.maps.LatLng(a.lat,a.lng):k(a,"x")&&k(a,"y")&&(c=new google.maps.LatLng(a.x,a.y)),g.isFunction(b.map.panTo)&&e!==c&&b.map.panTo(c)))},clear:function(a){var b=[],c="",d=0,f=0;"string"===typeof a&&(b=a.split(","));for(d=0;d<b.length;d+=1)if(c="_"+g.trim(b[d].toString().toLowerCase())+"s",e!==this[c]&&this[c].length){for(f=0;f<this[c].length;f+=1)this.map===this[c][f].getMap()&&
(this[c][f].set("visible",!1),this[c][f].setMap(this.map,null));this[c]=[]}},modify:function(a){var b=[],c=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","DrawPolyline"],["polygon","DrawPolygon"],["circle","DrawCircle"],["zoom","setZoom"]],d;if(e!==a){for(d=0;d<c.length;d+=1)k(a,c[d][0])&&b.push(c[d][1]);if(null!==this.map&&e!==this.map&&b)for(d=0;d<b.length;d+=1)if("function"===typeof this[b[d]])this[b[d]](this.map,a)}}};g.fn.tinyMap=function(a){var b=arguments,c=[],d=
{};return"string"===typeof a?(this.each(function(){d=g.data(this,"tinyMap");d instanceof n&&"function"===typeof d[a]&&(c=d[a].apply(d,Array.prototype.slice.call(b,1)))}),e!==c?c:this):this.each(function(){g.data(this,"tinyMap")||g.data(this,"tinyMap",new n(this,a))})}})(jQuery,window,document);
